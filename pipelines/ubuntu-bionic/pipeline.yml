groups:
- jobs:
  - manual-trigger-master
  - create-story-master
  - create-story-usn-master
  - bump-bosh-agent-master
  - bats-master
  - build-vcloud-esxi-master
  - build-vsphere-esxi-master
  - build-openstack-kvm-master
  - build-google-kvm-master
  - build-alicloud-kvm-master
  - build-azure-hyperv-master
  - build-aws-xen-hvm-master
  - build-warden-boshlite-master
  - test-stemcells-master
  - build-stemcell-master
  - test-unit-master
  - build-os-image-master
  - bump-os-image-master
  - notify-of-usn
  name: master
jobs:
- name: manual-trigger-master
  plan:
  - get: bosh-stemcells-ci
  - file: bosh-stemcells-ci/tasks/write-bump-message.yml
    params:
      MESSAGE_PREFIX: Manual bump
    task: write-message
  - params:
      file: message/message.txt
    put: stemcell-trigger-master
- name: create-story-master
  plan:
  - aggregate:
    - get: every-2-weeks-on-monday
      trigger: true
    - get: bosh-stemcells-ci
    - get: bosh-linux-stemcell-builder
      resource: bosh-linux-stemcell-builder-master
  - file: bosh-stemcells-ci/tasks/create-story.yml
    params:
      BRANCH: ubuntu-bionic/master
      DESCRIPTION: periodic bump
      PROJECT_ID: ((story_creator_tracker_project_id))
      TOKEN: ((story_creator_tracker_token))
    task: create-story
  - file: bosh-stemcells-ci/tasks/write-bump-message.yml
    params:
      MESSAGE_PREFIX: Periodic bump
    task: write-message
  - params:
      file: message/message.txt
    put: stemcell-trigger-master
- name: create-story-usn-master
  plan:
  - aggregate:
    - get: bosh-stemcells-ci
    - get: bosh-linux-stemcell-builder
      resource: bosh-linux-stemcell-builder-master
    - get: bionic-usn
      trigger: true
  - file: bosh-stemcells-ci/tasks/create-story.yml
    params:
      BRANCH: ubuntu-bionic/master
      DESCRIPTION: ubuntu *security* notice
      PROJECT_ID: ((story_creator_private_tracker_project_id))
      TOKEN: ((story_creator_tracker_token))
    task: create-story
  - file: bosh-stemcells-ci/tasks/write-bump-message.yml
    params:
      MESSAGE_PREFIX: Addresses
    task: write-message
  - params:
      file: message/message.txt
    put: stemcell-trigger-master
- name: build-os-image-master
  plan:
  - get: bosh-stemcells-ci
  - get: bosh-linux-stemcell-builder
    resource: bosh-linux-stemcell-builder-master
  - get: stemcell-trigger-master
    trigger: true
  - file: bosh-stemcells-ci/pipelines/ubuntu-bionic/tasks/build-os-image.yml
    params:
      OPERATING_SYSTEM_NAME: ubuntu
      OPERATING_SYSTEM_VERSION: bionic
    privileged: true
    task: build
  - params:
      acl: public-read
      file: os-image/ubuntu-bionic.tgz
    put: os-image-tarball-master
- name: bump-os-image-master
  plan:
  - aggregate:
    - get: bosh-stemcells-ci
    - get: bosh-linux-stemcell-builder
      passed:
      - build-os-image-master
      resource: bosh-linux-stemcell-builder-master
    - get: stemcell-trigger-master
      passed:
      - build-os-image-master
      trigger: true
    - get: os-image-tarball-master
      passed:
      - build-os-image-master
  - file: bosh-stemcells-ci/tasks/os-images/bump-os-image.yml
    input_mapping:
      image-tarball: os-image-tarball-master
    params:
      OS_NAME: ubuntu
      OS_VERSION: bionic
    task: bump-os-image
  - params:
      rebase: true
      repository: bosh-linux-stemcell-builder-push
    put: bosh-linux-stemcell-builder-push-master
- name: bump-bosh-agent-master
  plan:
  - get: bosh-agent
    params:
      skip_download: true
    resource: bosh-agent-master
    trigger: true
  - get: bosh-stemcells-ci
  - get: bosh-linux-stemcell-builder
    resource: bosh-linux-stemcell-builder-master
  - file: bosh-stemcells-ci/tasks/bump-bosh-agent.yml
    task: bump
  - params:
      rebase: true
      repository: bosh-linux-stemcell-builder
    put: bosh-linux-stemcell-builder-push-master
  serial: true
- name: test-unit-master
  plan:
  - get: bosh-stemcells-ci
  - get: bosh-linux-stemcell-builder
    resource: bosh-linux-stemcell-builder-master
    trigger: true
  - get: stemcell-trigger-master
    passed:
    - bump-os-image-master
    trigger: true
  - file: bosh-stemcells-ci/tasks/test-unit.yml
    task: test-unit
  serial: true
- name: build-stemcell-master
  plan:
  - get: bosh-stemcells-ci
  - get: bosh-linux-stemcell-builder
    passed:
    - test-unit-master
    resource: bosh-linux-stemcell-builder-master
    trigger: true
  - get: stemcell-trigger-master
    passed:
    - test-unit-master
    trigger: true
  - get: version
    params:
      bump: major
    resource: version-master
  - params:
      file: version/number
    put: version-master
  serial: true
- name: test-stemcells-master
  plan:
  - do:
    - aggregate:
      - get: version
        passed:
        - build-warden-boshlite-master
        - build-aws-xen-hvm-master
        - build-azure-hyperv-master
        - build-google-kvm-master
        - build-openstack-kvm-master
        - build-vsphere-esxi-master
        - build-vcloud-esxi-master
        resource: version-master
        trigger: true
      - get: bosh-stemcells-ci
      - get: bosh-linux-stemcell-builder
        resource: bosh-linux-stemcell-builder-master
      - get: bosh-deployment
      - get: bosh-cli
      - get: syslog-release
      - get: os-conf-release
      - get: stemcell
        passed:
        - build-vsphere-esxi-master
        resource: vsphere-esxi-master
        tags:
        - vsphere-v6.5
      - get: stemcell-trigger-master
        passed:
        - build-warden-boshlite-master
        - build-aws-xen-hvm-master
        - build-azure-hyperv-master
        - build-google-kvm-master
        - build-openstack-kvm-master
        - build-vsphere-esxi-master
        - build-vcloud-esxi-master
        trigger: true
    - params:
        acquire: true
      put: environment
    - do:
      - file: bosh-stemcells-ci/tasks/deploy-director.yml
        params:
          BOSH_vcenter_cluster: ((vcenter-cluster))
          BOSH_vcenter_dc: ((vcenter-dc))
          BOSH_vcenter_disks: ((vcenter-disk-path))
          BOSH_vcenter_ds: ((vcenter-datastore))
          BOSH_vcenter_ip: ((vcenter-ip))
          BOSH_vcenter_password: ((vcenter-password))
          BOSH_vcenter_rp: ((vcenter-rp))
          BOSH_vcenter_templates: ((vcenter-template-folder))
          BOSH_vcenter_user: ((vcenter-user))
          BOSH_vcenter_vms: ((vcenter-vm-folder))
        tags:
        - vsphere-v6.5
        task: deploy-director
      - attempts: 3
        file: bosh-stemcells-ci/tasks/test-stemcell.yml
        params:
          BOSH_os_name: ubuntu-bionic
          package: ipv4director
        tags:
        - vsphere-v6.5
        task: test-stemcell
      ensure:
        file: bosh-stemcells-ci/tasks/teardown.yml
        tags:
        - vsphere-v6.5
        task: teardown
    ensure:
      params:
        release: environment
      put: environment
  serial: true
- name: build-warden-boshlite-master
  plan:
  - aggregate:
    - get: version
      passed:
      - build-stemcell-master
      resource: version-master
      trigger: true
    - get: bosh-stemcells-ci
    - get: stemcell-trigger-master
      passed:
      - build-stemcell-master
      trigger: true
    - get: bosh-linux-stemcell-builder
      passed:
      - build-stemcell-master
      resource: bosh-linux-stemcell-builder-master
    - get: stemcells-index
  - attempts: 3
    file: bosh-stemcells-ci/tasks/build.yml
    params:
      HYPERVISOR: boshlite
      IAAS: warden
      OS_NAME: ubuntu
      OS_VERSION: bionic
      STEMCELL_BUCKET: bosh-core-stemcells-candidate
    privileged: true
    task: create-stemcell
  - aggregate:
    - attempts: 3
      params:
        file: stemcell/*.tgz
      put: warden-boshlite-master
  - attempts: 3
    params:
      rebase: true
      repository: stemcells-index
    put: stemcells-index
- name: build-aws-xen-hvm-master
  plan:
  - aggregate:
    - get: version
      passed:
      - build-stemcell-master
      resource: version-master
      trigger: true
    - get: bosh-stemcells-ci
    - get: stemcell-trigger-master
      passed:
      - build-stemcell-master
      trigger: true
    - get: bosh-linux-stemcell-builder
      passed:
      - build-stemcell-master
      resource: bosh-linux-stemcell-builder-master
    - get: stemcells-index
  - attempts: 3
    file: bosh-stemcells-ci/tasks/build.yml
    params:
      HYPERVISOR: xen-hvm
      IAAS: aws
      OS_NAME: ubuntu
      OS_VERSION: bionic
      STEMCELL_BUCKET: bosh-core-stemcells-candidate
    privileged: true
    task: create-stemcell
  - aggregate:
    - attempts: 3
      params:
        file: stemcell/*.tgz
      put: aws-xen-hvm-master
  - attempts: 3
    params:
      rebase: true
      repository: stemcells-index
    put: stemcells-index
- name: build-azure-hyperv-master
  plan:
  - aggregate:
    - get: version
      passed:
      - build-stemcell-master
      resource: version-master
      trigger: true
    - get: bosh-stemcells-ci
    - get: stemcell-trigger-master
      passed:
      - build-stemcell-master
      trigger: true
    - get: bosh-linux-stemcell-builder
      passed:
      - build-stemcell-master
      resource: bosh-linux-stemcell-builder-master
    - get: stemcells-index
  - attempts: 3
    file: bosh-stemcells-ci/tasks/build.yml
    params:
      HYPERVISOR: hyperv
      IAAS: azure
      OS_NAME: ubuntu
      OS_VERSION: bionic
      STEMCELL_BUCKET: bosh-core-stemcells-candidate
    privileged: true
    task: create-stemcell
  - aggregate:
    - attempts: 3
      params:
        file: stemcell/*.tgz
      put: azure-hyperv-master
  - attempts: 3
    params:
      rebase: true
      repository: stemcells-index
    put: stemcells-index
- name: build-alicloud-kvm-master
  plan:
  - aggregate:
    - get: version
      passed:
      - build-stemcell-master
      resource: version-master
      trigger: true
    - get: bosh-stemcells-ci
    - get: stemcell-trigger-master
      passed:
      - build-stemcell-master
      trigger: true
    - get: bosh-linux-stemcell-builder
      passed:
      - build-stemcell-master
      resource: bosh-linux-stemcell-builder-master
    - get: stemcells-index
  - attempts: 3
    file: bosh-stemcells-ci/tasks/build.yml
    params:
      HYPERVISOR: kvm
      IAAS: alicloud
      OS_NAME: ubuntu
      OS_VERSION: bionic
      STEMCELL_BUCKET: bosh-core-stemcells-candidate
    privileged: true
    task: create-stemcell
  - aggregate:
    - attempts: 3
      params:
        file: stemcell/*-go_agent.tgz
      put: alicloud-kvm-master
  - attempts: 3
    params:
      rebase: true
      repository: stemcells-index
    put: stemcells-index
- name: build-google-kvm-master
  plan:
  - aggregate:
    - get: version
      passed:
      - build-stemcell-master
      resource: version-master
      trigger: true
    - get: bosh-stemcells-ci
    - get: stemcell-trigger-master
      passed:
      - build-stemcell-master
      trigger: true
    - get: bosh-linux-stemcell-builder
      passed:
      - build-stemcell-master
      resource: bosh-linux-stemcell-builder-master
    - get: stemcells-index
  - attempts: 3
    file: bosh-stemcells-ci/tasks/build.yml
    params:
      HYPERVISOR: kvm
      IAAS: google
      OS_NAME: ubuntu
      OS_VERSION: bionic
      STEMCELL_BUCKET: bosh-core-stemcells-candidate
    privileged: true
    task: create-stemcell
  - aggregate:
    - attempts: 3
      params:
        file: stemcell/*-go_agent.tgz
      put: google-kvm-master
  - attempts: 3
    params:
      rebase: true
      repository: stemcells-index
    put: stemcells-index
- name: build-openstack-kvm-master
  plan:
  - aggregate:
    - get: version
      passed:
      - build-stemcell-master
      resource: version-master
      trigger: true
    - get: bosh-stemcells-ci
    - get: stemcell-trigger-master
      passed:
      - build-stemcell-master
      trigger: true
    - get: bosh-linux-stemcell-builder
      passed:
      - build-stemcell-master
      resource: bosh-linux-stemcell-builder-master
    - get: stemcells-index
  - attempts: 3
    file: bosh-stemcells-ci/tasks/build.yml
    params:
      HYPERVISOR: kvm
      IAAS: openstack
      OS_NAME: ubuntu
      OS_VERSION: bionic
      STEMCELL_BUCKET: bosh-core-stemcells-candidate
    privileged: true
    task: create-stemcell
  - aggregate:
    - attempts: 3
      params:
        file: stemcell/*-raw.tgz
      put: openstack-kvm-raw-master
    - attempts: 3
      params:
        file: stemcell/*-go_agent.tgz
      put: openstack-kvm-master
  - attempts: 3
    params:
      rebase: true
      repository: stemcells-index
    put: stemcells-index
- name: build-vsphere-esxi-master
  plan:
  - aggregate:
    - get: version
      passed:
      - build-stemcell-master
      resource: version-master
      trigger: true
    - get: bosh-stemcells-ci
    - get: stemcell-trigger-master
      passed:
      - build-stemcell-master
      trigger: true
    - get: bosh-linux-stemcell-builder
      passed:
      - build-stemcell-master
      resource: bosh-linux-stemcell-builder-master
    - get: stemcells-index
  - attempts: 3
    file: bosh-stemcells-ci/tasks/build.yml
    params:
      HYPERVISOR: esxi
      IAAS: vsphere
      OS_NAME: ubuntu
      OS_VERSION: bionic
      STEMCELL_BUCKET: bosh-core-stemcells-candidate
    privileged: true
    task: create-stemcell
  - aggregate:
    - attempts: 3
      params:
        file: stemcell/*.tgz
      put: vsphere-esxi-master
  - attempts: 3
    params:
      rebase: true
      repository: stemcells-index
    put: stemcells-index
- name: build-vcloud-esxi-master
  plan:
  - aggregate:
    - get: version
      passed:
      - build-stemcell-master
      resource: version-master
      trigger: true
    - get: bosh-stemcells-ci
    - get: stemcell-trigger-master
      passed:
      - build-stemcell-master
      trigger: true
    - get: bosh-linux-stemcell-builder
      passed:
      - build-stemcell-master
      resource: bosh-linux-stemcell-builder-master
    - get: stemcells-index
  - attempts: 3
    file: bosh-stemcells-ci/tasks/build.yml
    params:
      HYPERVISOR: esxi
      IAAS: vcloud
      OS_NAME: ubuntu
      OS_VERSION: bionic
      STEMCELL_BUCKET: bosh-core-stemcells-candidate
    privileged: true
    task: create-stemcell
  - aggregate:
    - attempts: 3
      params:
        file: stemcell/*.tgz
      put: vcloud-esxi-master
  - attempts: 3
    params:
      rebase: true
      repository: stemcells-index
    put: stemcells-index
- name: bats-master
  plan:
  - do:
    - aggregate:
      - get: stemcell
        passed:
        - build-vsphere-esxi-master
        resource: vsphere-esxi-master
        tags:
        - vsphere-v6.5
        trigger: true
      - get: bosh-cli
      - get: bats
      - get: bosh-deployment
      - get: bosh-stemcells-ci
      - get: bosh-linux-stemcell-builder
        passed:
        - build-warden-boshlite-master
        - build-aws-xen-hvm-master
        - build-azure-hyperv-master
        - build-google-kvm-master
        - build-openstack-kvm-master
        - build-vsphere-esxi-master
        - build-vcloud-esxi-master
        resource: bosh-linux-stemcell-builder-master
      - get: version
        passed:
        - build-warden-boshlite-master
        - build-aws-xen-hvm-master
        - build-azure-hyperv-master
        - build-google-kvm-master
        - build-openstack-kvm-master
        - build-vsphere-esxi-master
        - build-vcloud-esxi-master
        resource: version-master
      - get: stemcell-trigger-master
        passed:
        - build-warden-boshlite-master
        - build-aws-xen-hvm-master
        - build-azure-hyperv-master
        - build-google-kvm-master
        - build-openstack-kvm-master
        - build-vsphere-esxi-master
        - build-vcloud-esxi-master
        trigger: true
    - params:
        acquire: true
      put: environment
    - do:
      - file: bosh-stemcells-ci/bats/tasks/deploy-director.yml
        params:
          BAT_INFRASTRUCTURE: vsphere
          BOSH_CLIENT: ((stemcell-test-director-username))
          BOSH_CLIENT_SECRET: ((stemcell-test-director-password))
          BOSH_VSPHERE_VCENTER: ((vcenter-ip))
          BOSH_VSPHERE_VCENTER_CLUSTER: ((vcenter-cluster))
          BOSH_VSPHERE_VCENTER_DATASTORE: ((vcenter-datastore))
          BOSH_VSPHERE_VCENTER_DC: ((vcenter-dc))
          BOSH_VSPHERE_VCENTER_DISK_PATH: ((vcenter-disk-path))
          BOSH_VSPHERE_VCENTER_PASSWORD: ((vcenter-password))
          BOSH_VSPHERE_VCENTER_RP: ((vcenter-rp))
          BOSH_VSPHERE_VCENTER_TEMPLATE_FOLDER: ((vcenter-template-folder))
          BOSH_VSPHERE_VCENTER_USER: ((vcenter-user))
          BOSH_VSPHERE_VCENTER_VLAN: ((vcenter-vlan))
          BOSH_VSPHERE_VCENTER_VM_FOLDER: ((vcenter-vm-folder))
          BOSH_VSPHERE_VERSION: ((vsphere-version))
        tags:
        - vsphere-v6.5
        task: deploy-director
      - file: bosh-stemcells-ci/bats/iaas/vsphere/prepare-bats-config.yml
        params:
          STEMCELL_NAME: bosh-vsphere-esxi-ubuntu-bionic-go_agent
        tags:
        - vsphere-v6.5
        task: prepare-bats
      - file: bats/ci/tasks/run-bats.yml
        tags:
        - vsphere-v6.5
        task: run-bats
      ensure:
        do:
        - file: bosh-stemcells-ci/bats/tasks/destroy-director.yml
          tags:
          - vsphere-v6.5
          task: teardown
    ensure:
      do:
      - params:
          release: environment
        put: environment
  serial: true
- name: notify-of-usn
  plan:
  - get: bionic-usn
    trigger: true
  - config:
      image_resource:
        source:
          repository: bosh/main
        type: registry-image
      inputs:
      - name: bionic-usn
      outputs:
      - name: slack-message
      platform: linux
      run:
        args:
        - -c
        - |
          set -exu -o pipefail
          cat <<EOF > template.json
          {
            "attachments": {
              "color": "#ff0000",
                "thumb_url": "http://www.free-icons-download.net/images/lock-icon-66412.png",
                "footer": "USN Notification",
                "footer_icon": "https://i.imgur.com/7H8ZIq1.png",
                "mrkdwn_in": ["fields"],
                "fields": [
                {"title": "Priorities", "short": true, "value": (.priorities | join(", "))},
                {"title": "Date", "short": true, "value": .date},
                {"title": "Description", "short": false, "value": .description},
                {"title": "CVEs", "short": false, "value": (.cves | join("\n"))}
                ]
            }
          }
          EOF
          cat bionic-usn/usn.json | jq -r "$(cat template.json)" | tee slack-message/attachments
          cat bionic-usn/usn.json | jq -r '"New USN for Bionic: *<\(.url)|\(.title)>*"' | tee slack-message/message
        path: /bin/bash
    task: build-slack-message
  - params:
      attachments_file: slack-message/attachments
      channel: ((usn_notifications_slack_channel_name))
      icon_url: https://i.imgur.com/A0Vlw5t.png
      text_file: slack-message/message
    put: slack-alert
resource_types:
- name: usn
  source:
    repository: bosh/usn-resource
  type: registry-image
- name: metalink-repository
  source:
    repository: dpb587/metalink-repository-resource
  type: registry-image
- name: slack-notification
  source:
    repository: cfcommunity/slack-notification-resource
    tag: latest
  type: registry-image
resources:
- name: bosh-stemcells-ci
  source:
    branch: master
    uri: https://github.com/cloudfoundry/bosh-stemcells-ci
  type: git
- name: bats
  source:
    branch: master
    uri: https://github.com/cloudfoundry/bosh-acceptance-tests.git
  type: git
- name: stemcells-index
  source:
    branch: master
    private_key: ((boshio_stemcells_index_key))
    uri: git@github.com:bosh-io/stemcells-core-index.git
  type: git
- name: syslog-release
  source:
    repository: cloudfoundry/syslog-release
  type: bosh-io-release
- name: os-conf-release
  source:
    repository: cloudfoundry/os-conf-release
  type: bosh-io-release
- name: bosh-deployment
  source:
    branch: master
    uri: https://github.com/cloudfoundry/bosh-deployment
  type: git
- name: bosh-cli
  source:
    bucket: bosh-cli-artifacts
    regexp: bosh-cli-([0-9.]+)-linux-amd64
    region_name: us-east-1
  type: s3
- name: environment
  source:
    branch: master
    pool: vsphere
    private_key: ((github_deployment_key__bosh-cpi-environments))
    uri: git@github.com:pivotal-cf-experimental/bats-concourse-pool.git
  type: pool
- name: every-2-weeks-on-monday
  source:
    days:
    - Monday
    interval: 192h
    location: America/Los_Angeles
    start: "6:00"
    stop: "8:30"
  type: time
- name: bionic-usn
  source:
    os: ubuntu-16.04-lts
    priorities:
    - high
    - critical
  type: usn
- name: os-image-tarball-master
  source:
    access_key_id: ((osimage_aws_access_key))
    bucket: ((osimage_bucket))
    secret_access_key: ((osimage_aws_secret_key))
    versioned_file: bosh-ubuntu-bionic-os-image.tgz
  type: s3
- name: bosh-linux-stemcell-builder-push-master
  source:
    branch: master
    private_key: ((bosh_src_key))
    uri: git@github.com:cloudfoundry/bosh-linux-stemcell-builder
  type: git
- name: bosh-linux-stemcell-builder-master
  source:
    branch: master
    ignore_paths:
    - bosh-stemcell/image-metalinks/ubuntu-trusty.meta4
    - bosh-stemcell/image-metalinks/centos-7.meta4.meta4
    uri: https://github.com/cloudfoundry/bosh-linux-stemcell-builder
  type: git
- name: version-master
  source:
    access_key_id: ((stemcell_aws_access_key))
    bucket: ((candidate_stemcell_bucket))
    driver: s3
    initial_version: 0.0.0
    key: bosh-stemcell/ubuntu-bionic/master-version
    secret_access_key: ((stemcell_aws_secret_key))
  type: semver
- name: bosh-agent-master
  source:
    uri: git+https://github.com/cloudfoundry/bosh-agent-index.git
    version: '*'
  type: metalink-repository
- name: aws-xen-hvm-master
  source:
    access_key_id: ((stemcell_aws_access_key))
    bucket: ((candidate_stemcell_bucket))
    regexp: aws/bosh-stemcell-(.+)-aws-xen-hvm-ubuntu-bionic-go_agent.tgz
    secret_access_key: ((stemcell_aws_secret_key))
  type: s3
- name: azure-hyperv-master
  source:
    access_key_id: ((stemcell_aws_access_key))
    bucket: ((candidate_stemcell_bucket))
    regexp: azure/bosh-stemcell-(.+)-azure-hyperv-ubuntu-bionic-go_agent.tgz
    secret_access_key: ((stemcell_aws_secret_key))
  type: s3
- name: vsphere-esxi-master
  source:
    access_key_id: ((stemcell_aws_access_key))
    bucket: ((candidate_stemcell_bucket))
    regexp: vsphere/bosh-stemcell-(.+)-vsphere-esxi-ubuntu-bionic-go_agent.tgz
    secret_access_key: ((stemcell_aws_secret_key))
  type: s3
- name: alicloud-kvm-master
  source:
    access_key_id: ((stemcell_aws_access_key))
    bucket: ((candidate_stemcell_bucket))
    regexp: alicloud/bosh-stemcell-(.+)-alicloud-kvm-ubuntu-bionic-go_agent.tgz
    secret_access_key: ((stemcell_aws_secret_key))
  type: s3
- name: google-kvm-master
  source:
    access_key_id: ((stemcell_aws_access_key))
    bucket: ((candidate_stemcell_bucket))
    regexp: google/bosh-stemcell-(.+)-google-kvm-ubuntu-bionic-go_agent.tgz
    secret_access_key: ((stemcell_aws_secret_key))
  type: s3
- name: openstack-kvm-master
  source:
    access_key_id: ((stemcell_aws_access_key))
    bucket: ((candidate_stemcell_bucket))
    regexp: openstack/bosh-stemcell-(.+)-openstack-kvm-ubuntu-bionic-go_agent.tgz
    secret_access_key: ((stemcell_aws_secret_key))
  type: s3
- name: openstack-kvm-raw-master
  source:
    access_key_id: ((stemcell_aws_access_key))
    bucket: ((candidate_stemcell_bucket))
    regexp: openstack/bosh-stemcell-(.+)-openstack-kvm-ubuntu-bionic-go_agent-raw.tgz
    secret_access_key: ((stemcell_aws_secret_key))
  type: s3
- name: vcloud-esxi-master
  source:
    access_key_id: ((stemcell_aws_access_key))
    bucket: ((candidate_stemcell_bucket))
    regexp: vcloud/bosh-stemcell-(.+)-vcloud-esxi-ubuntu-bionic-go_agent.tgz
    secret_access_key: ((stemcell_aws_secret_key))
  type: s3
- name: warden-boshlite-master
  source:
    access_key_id: ((stemcell_aws_access_key))
    bucket: ((candidate_stemcell_bucket))
    regexp: warden/bosh-stemcell-(.+)-warden-boshlite-ubuntu-bionic-go_agent.tgz
    secret_access_key: ((stemcell_aws_secret_key))
  type: s3
- name: stemcell-trigger-master
  source:
    access_key_id: ((bosh_usn_and_periodic_aws_access_key_id))
    bucket: bosh-stemcell-triggers
    secret_access_key: ((bosh_usn_and_periodic_aws_secret_access_key))
    versioned_file: bionic/master/stemcell-trigger
  type: s3
- name: slack-alert
  source:
    url: ((slack_hook_url))
  type: slack-notification
